<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í‚¤ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background: #a29bfe;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 5px;
        }

        button:hover {
            background: #6c5ce7;
        }

        #result {
            margin-top: 20px;
            padding: 15px;
            background: #16213e;
            border-radius: 5px;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .success {
            color: #00d2d3;
        }

        .error {
            color: #ff4757;
        }
    </style>
</head>

<body>
    <h1>ğŸ”‘ Gemini API í‚¤ í…ŒìŠ¤íŠ¸</h1>
    <p>API í‚¤ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>

    <input type="password" id="apiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” (AIza...)" />
    <button onclick="testAPI()">API í…ŒìŠ¤íŠ¸</button>

    <div id="result"></div>

    <script>
        // localStorageì—ì„œ ì €ì¥ëœ í‚¤ ë¶ˆëŸ¬ì˜¤ê¸°
        const savedKey = localStorage.getItem('gemini_api_key');
        if (savedKey) {
            document.getElementById('apiKey').value = savedKey;
        }

        async function testAPI() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const resultDiv = document.getElementById('result');

            if (!apiKey) {
                resultDiv.innerHTML = '<span class="error">âŒ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>';
                return;
            }

            resultDiv.innerHTML = 'â³ API í…ŒìŠ¤íŠ¸ ì¤‘...';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: 'ì•ˆë…•í•˜ì„¸ìš”'
                            }]
                        }]
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    // ì˜¤ë¥˜ ìƒì„¸ ì •ë³´
                    resultDiv.innerHTML = `
<span class="error">âŒ API í˜¸ì¶œ ì‹¤íŒ¨</span>

<strong>HTTP ìƒíƒœ:</strong> ${response.status} ${response.statusText}

<strong>ì˜¤ë¥˜ ìƒì„¸:</strong>
${JSON.stringify(data, null, 2)}

<strong>ê°€ëŠ¥í•œ ì›ì¸:</strong>
${response.status === 400 ? '- API í‚¤ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆê±°ë‚˜ ìš”ì²­ í˜•ì‹ ì˜¤ë¥˜' : ''}
${response.status === 403 ? '- API í‚¤ê°€ ë¹„í™œì„±í™”ë˜ì—ˆê±°ë‚˜ ê¶Œí•œ ì—†ìŒ\n- Gemini APIê°€ í™œì„±í™”ë˜ì§€ ì•ŠìŒ' : ''}
${response.status === 429 ? '- API í• ë‹¹ëŸ‰ ì´ˆê³¼' : ''}

<strong>í•´ê²° ë°©ë²•:</strong>
1. https://makersuite.google.com/app/apikey ì—ì„œ ìƒˆ API í‚¤ ë°œê¸‰
2. API í‚¤ê°€ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
3. Gemini APIê°€ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
                    `;
                } else {
                    // ì„±ê³µ
                    const responseText = data.candidates[0].content.parts[0].text;
                    resultDiv.innerHTML = `
<span class="success">âœ… API í‚¤ê°€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!</span>

<strong>API ì‘ë‹µ:</strong>
${responseText}

<strong>API í‚¤:</strong> ${apiKey.substring(0, 10)}...

ì´ API í‚¤ë¥¼ Vibe Capturer ì„¤ì •ì— ì…ë ¥í•˜ì„¸ìš”.
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
<span class="error">âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜</span>

<strong>ì˜¤ë¥˜ ë©”ì‹œì§€:</strong>
${error.message}

<strong>ê°€ëŠ¥í•œ ì›ì¸:</strong>
- ì¸í„°ë„· ì—°ê²° ë¬¸ì œ
- CORS ì˜¤ë¥˜
- ë°©í™”ë²½ ì°¨ë‹¨

<strong>í•´ê²° ë°©ë²•:</strong>
1. ì¸í„°ë„· ì—°ê²° í™•ì¸
2. ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì‹œë„
                `;
            }
        }
    </script>
</body>

</html>